<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: GraphQL::Execution::Errors
  
    &mdash; GraphQL Ruby API Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "GraphQL::Execution::Errors";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Execution.html" title="GraphQL::Execution (module)">Execution</a></span></span>
     &raquo; 
    <span class="title">Errors</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: GraphQL::Execution::Errors
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">GraphQL::Execution::Errors</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/graphql/execution/errors.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A plugin that wraps query execution with error handling.
Supports class-based schemas and the new <span class='object_link'><a href="Interpreter.html" title="GraphQL::Execution::Interpreter (class)">Interpreter</a></span> runtime only.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Handling ActiveRecord::NotFound</p>
</div></p>
      
      <pre class="example code"><code>
<span class='kw'>class</span> <span class='const'>MySchema</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Schema.html" title="GraphQL::Schema (class)">Schema</a></span></span>
  <span class='id identifier rubyid_use'>use</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Execution.html" title="GraphQL::Execution (module)">Execution</a></span></span><span class='op'>::</span><span class='const'>Errors</span>

  <span class='id identifier rubyid_rescue_from'>rescue_from</span><span class='lparen'>(</span><span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>NotFound</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_obj'>obj</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_field'>field</span><span class='op'>|</span>
    <span class='const'>ErrorTracker</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Not Found: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_err'>err</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="NEW_HANDLER_HASH-constant" class="">NEW_HANDLER_HASH =
          
        </dt>
        <dd><pre class="code"><span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span> <span class='tlambeg'>{</span>
  <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>class:</span> <span class='id identifier rubyid_k'>k</span><span class='comma'>,</span>
    <span class='label'>handler:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>subclass_handlers:</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='const'><span class='object_link'><a href="#NEW_HANDLER_HASH-constant" title="GraphQL::Execution::Errors::NEW_HANDLER_HASH (constant)">NEW_HANDLER_HASH</a></span></span><span class='rparen'>)</span><span class='comma'>,</span>
   <span class='rbrace'>}</span>
<span class='rbrace'>}</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use-class_method" title="use (class method)">.<strong>use</strong>(schema)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_rescue-instance_method" title="#each_rescue (instance method)">#<strong>each_rescue</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_handler_for-instance_method" title="#find_handler_for (instance method)">#<strong>find_handler_for</strong>(error_class)  &#x21d2; Proc<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The handler for <code>error_class</code>, if one was registered on this schema or inherited.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(schema)  &#x21d2; Errors </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Errors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rescue_from-instance_method" title="#rescue_from (instance method)">#<strong>rescue_from</strong>(error_class, error_handler)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Register this handler, updating the internal handler index to maintain least-to-most specific.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_error_handling-instance_method" title="#with_error_handling (instance method)">#<strong>with_error_handling</strong>(ctx)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Call the given block with the schema’s configured error handlers.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(schema)  &#x21d2; <tt><span class='object_link'><a href="" title="GraphQL::Execution::Errors (class)">Errors</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of Errors.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/execution/errors.rb', line 33</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_schema'>schema</span><span class='rparen'>)</span>
  <span class='ivar'>@schema</span> <span class='op'>=</span> <span class='id identifier rubyid_schema'>schema</span>
  <span class='ivar'>@handlers</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>class:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>handler:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>subclass_handlers:</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='const'><span class='object_link'><a href="#NEW_HANDLER_HASH-constant" title="GraphQL::Execution::Errors::NEW_HANDLER_HASH (constant)">NEW_HANDLER_HASH</a></span></span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="use-class_method">
  
    .<strong>use</strong>(schema)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/execution/errors.rb', line 20</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='id identifier rubyid_schema'>schema</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_definition_line'>definition_line</span> <span class='op'>=</span> <span class='id identifier rubyid_caller'>caller</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Deprecation.html" title="GraphQL::Deprecation (module)">Deprecation</a></span></span><span class='period'>.</span><span class='id identifier rubyid_warn'><span class='object_link'><a href="../Deprecation.html#warn-class_method" title="GraphQL::Deprecation.warn (method)">warn</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GraphQL::Execution::Errors is now installed by default, remove `use GraphQL::Execution::Errors` from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_definition_line'>definition_line</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="each_rescue-instance_method">
  
    #<strong>each_rescue</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45
46
47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/execution/errors.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_rescue'>each_rescue</span>
  <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='ivar'>@handlers</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_handlers'>handlers</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_handler'>handler</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='lbracket'>[</span><span class='symbol'>:handler</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handlers'>handlers</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_handler'>handler</span><span class='lbracket'>[</span><span class='symbol'>:subclass_handlers</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_handler_for-instance_method">
  
    #<strong>find_handler_for</strong>(error_class)  &#x21d2; <tt>Proc</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns The handler for <code>error_class</code>, if one was registered on this schema or inherited.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Proc</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The handler for <code>error_class</code>, if one was registered on this schema or inherited</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/execution/errors.rb', line 125</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_handler_for'>find_handler_for</span><span class='lparen'>(</span><span class='id identifier rubyid_error_class'>error_class</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='ivar'>@handlers</span><span class='lbracket'>[</span><span class='symbol'>:subclass_handlers</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_handlers'>handlers</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid__err_class'>_err_class</span><span class='comma'>,</span> <span class='id identifier rubyid_next_handler'>next_handler</span> <span class='op'>=</span> <span class='id identifier rubyid_handlers'>handlers</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_err_class'>err_class</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>|</span> <span class='id identifier rubyid_error_class'>error_class</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_err_class'>err_class</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_next_handler'>next_handler</span>
      <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='id identifier rubyid_next_handler'>next_handler</span><span class='lbracket'>[</span><span class='symbol'>:subclass_handlers</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_next_handler'>next_handler</span>
    <span class='kw'>else</span>
      <span class='comment'># Don&#39;t reassign `handler` --
</span>      <span class='comment'># let the previous assignment carry over outside this block.
</span>      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># check for a handler from a parent class:
</span>  <span class='kw'>if</span> <span class='ivar'>@schema</span><span class='period'>.</span><span class='id identifier rubyid_superclass'>superclass</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:error_handler</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_parent_errors'>parent_errors</span> <span class='op'>=</span> <span class='ivar'>@schema</span><span class='period'>.</span><span class='id identifier rubyid_superclass'>superclass</span><span class='period'>.</span><span class='id identifier rubyid_error_handler'>error_handler</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_parent_handler'>parent_handler</span> <span class='op'>=</span> <span class='id identifier rubyid_parent_errors'>parent_errors</span><span class='period'>.</span><span class='id identifier rubyid_find_handler_for'>find_handler_for</span><span class='lparen'>(</span><span class='id identifier rubyid_error_class'>error_class</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># If the inherited handler is more specific than the one defined here,
</span>  <span class='comment'># use it.
</span>  <span class='comment'># If it&#39;s a tie (or there is no parent handler), use the one defined here.
</span>  <span class='comment'># If there&#39;s an inherited one, but not one defined here, use the inherited one.
</span>  <span class='comment'># Otherwise, there&#39;s no handler for this error, return `nil`.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_parent_handler'>parent_handler</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_handler'>handler</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_parent_handler'>parent_handler</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_handler'>handler</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_parent_handler'>parent_handler</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_handler'>handler</span>
    <span class='id identifier rubyid_handler'>handler</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_parent_handler'>parent_handler</span>
    <span class='id identifier rubyid_parent_handler'>parent_handler</span>
  <span class='kw'>else</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rescue_from-instance_method">
  
    #<strong>rescue_from</strong>(error_class, error_handler)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Register this handler, updating the
internal handler index to maintain least-to-most specific.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>error_class</span>
      
      
        <span class='type'>(<tt>Class&lt;Exception&gt;</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>error_handler</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/execution/errors.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rescue_from'>rescue_from</span><span class='lparen'>(</span><span class='id identifier rubyid_error_class'>error_class</span><span class='comma'>,</span> <span class='id identifier rubyid_error_handler'>error_handler</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_subclasses_handlers'>subclasses_handlers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_this_level_subclasses'>this_level_subclasses</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='comment'># During this traversal, do two things:
</span>  <span class='comment'># - Identify any already-registered subclasses of this error class
</span>  <span class='comment'>#   and gather them up to be inserted _under_ this class
</span>  <span class='comment'># - Find the point in the index where this handler should be inserted
</span>  <span class='comment'>#   (That is, _under_ any superclasses, or at top-level, if there are no superclasses registered)
</span>  <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='ivar'>@handlers</span><span class='lbracket'>[</span><span class='symbol'>:subclass_handlers</span><span class='rbracket'>]</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_handlers'>handlers</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_this_level_subclasses'>this_level_subclasses</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
    <span class='comment'># First, identify already-loaded handlers that belong
</span>    <span class='comment'># _under_ this one. (That is, they&#39;re handlers
</span>    <span class='comment'># for subclasses of `error_class`.)
</span>    <span class='id identifier rubyid_handlers'>handlers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_err_class'>err_class</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_err_class'>err_class</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_error_class'>error_class</span>
        <span class='id identifier rubyid_subclasses_handlers'>subclasses_handlers</span><span class='lbracket'>[</span><span class='id identifier rubyid_err_class'>err_class</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_handler'>handler</span>
        <span class='id identifier rubyid_this_level_subclasses'>this_level_subclasses</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_err_class'>err_class</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='comment'># Any handlers that we&#39;ll be moving, delete them from this point in the index
</span>    <span class='id identifier rubyid_this_level_subclasses'>this_level_subclasses</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_err_class'>err_class</span><span class='op'>|</span>
      <span class='id identifier rubyid_handlers'>handlers</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_err_class'>err_class</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># See if any keys in this hash are superclasses of this new class:
</span>    <span class='id identifier rubyid_next_index_point'>next_index_point</span> <span class='op'>=</span> <span class='id identifier rubyid_handlers'>handlers</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_err_class'>err_class</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span><span class='op'>|</span> <span class='id identifier rubyid_error_class'>error_class</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_err_class'>err_class</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_next_index_point'>next_index_point</span>
      <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='id identifier rubyid_next_index_point'>next_index_point</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:subclass_handlers</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='comment'># this new handler doesn&#39;t belong to any sub-handlers,
</span>      <span class='comment'># so insert it in the current set of `handlers`
</span>      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='comment'># Having found the point at which to insert this handler,
</span>  <span class='comment'># register it and merge any subclass handlers back in at this point.
</span>  <span class='id identifier rubyid_this_class_handlers'>this_class_handlers</span> <span class='op'>=</span> <span class='id identifier rubyid_handlers'>handlers</span><span class='lbracket'>[</span><span class='id identifier rubyid_error_class'>error_class</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_this_class_handlers'>this_class_handlers</span><span class='lbracket'>[</span><span class='symbol'>:handler</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_error_handler'>error_handler</span>
  <span class='id identifier rubyid_this_class_handlers'>this_class_handlers</span><span class='lbracket'>[</span><span class='symbol'>:subclass_handlers</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_subclasses_handlers'>subclasses_handlers</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_error_handling-instance_method">
  
    #<strong>with_error_handling</strong>(ctx)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Call the given block with the schema’s configured error handlers.</p>

<p>If the block returns a lazy value, it’s not wrapped with error handling. That area will have to be wrapped itself.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ctx</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Query/Context.html" title="GraphQL::Query::Context (class)">GraphQL::Query::Context</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Either the result of the given block, or some object to replace the result, in case of error handling.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/execution/errors.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with_error_handling'>with_error_handling</span><span class='lparen'>(</span><span class='id identifier rubyid_ctx'>ctx</span><span class='rparen'>)</span>
  <span class='kw'>yield</span>
<span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_err'>err</span>
  <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_find_handler_for'>find_handler_for</span><span class='lparen'>(</span><span class='id identifier rubyid_err'>err</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_handler'>handler</span>
    <span class='id identifier rubyid_runtime_info'>runtime_info</span> <span class='op'>=</span> <span class='id identifier rubyid_ctx'>ctx</span><span class='period'>.</span><span class='id identifier rubyid_namespace'>namespace</span><span class='lparen'>(</span><span class='symbol'>:interpreter</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='id identifier rubyid_runtime_info'>runtime_info</span><span class='lbracket'>[</span><span class='symbol'>:current_object</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_runtime_info'>runtime_info</span><span class='lbracket'>[</span><span class='symbol'>:current_arguments</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid_runtime_info'>runtime_info</span><span class='lbracket'>[</span><span class='symbol'>:current_field</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Schema.html" title="GraphQL::Schema (class)">Schema</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Schema/Object.html" title="GraphQL::Schema::Object (class)">Object</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_handler'>handler</span><span class='lbracket'>[</span><span class='symbol'>:handler</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_obj'>obj</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_err'>err</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Nov 23 21:45:50 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.4).
</div>

    </div>
  </body>
</html>