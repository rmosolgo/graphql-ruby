<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: GraphQL::Dataloader
  
    &mdash; GraphQL Ruby API Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "GraphQL::Dataloader";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span>
     &raquo; 
    <span class="title">Dataloader</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: GraphQL::Dataloader
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">GraphQL::Dataloader</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/graphql/dataloader.rb<span class="defines">,<br />
  lib/graphql/dataloader/source.rb,<br /> lib/graphql/dataloader/request.rb,<br /> lib/graphql/dataloader/request_all.rb,<br /> lib/graphql/dataloader/null_dataloader.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>This plugin supports Fiber-based concurrency, along with <span class='object_link'><a href="Dataloader/Source.html" title="GraphQL::Dataloader::Source (class)">Source</a></span>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Installing Dataloader</p>
</div></p>
      
      <pre class="example code"><code>
<span class='kw'>class</span> <span class='const'>MySchema</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Schema.html" title="GraphQL::Schema (class)">Schema</a></span></span>
  <span class='id identifier rubyid_use'>use</span> <span class='const'><span class='object_link'><a href="../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'>Dataloader</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Waiting for batch-loaded data in a GraphQL field</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_field'>field</span> <span class='symbol'>:team</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Types.html" title="GraphQL::Types (module)">Types</a></span></span><span class='op'>::</span><span class='const'>Team</span><span class='comma'>,</span> <span class='label'>null:</span> <span class='kw'>true</span>

<span class='kw'>def</span> <span class='id identifier rubyid_team'>team</span>
  <span class='id identifier rubyid_dataloader'>dataloader</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='const'>Sources</span><span class='op'>::</span><span class='const'>Record</span><span class='comma'>,</span> <span class='const'>Team</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_team_id'>team_id</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Dataloader/NullDataloader.html" title="GraphQL::Dataloader::NullDataloader (class)">NullDataloader</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Dataloader/NullDataloader.html" title="GraphQL::Dataloader::NullDataloader (class)">NullDataloader</a></span>, <span class='object_link'><a href="Dataloader/Request.html" title="GraphQL::Dataloader::Request (class)">Request</a></span>, <span class='object_link'><a href="Dataloader/RequestAll.html" title="GraphQL::Dataloader::RequestAll (class)">RequestAll</a></span>, <span class='object_link'><a href="Dataloader/Source.html" title="GraphQL::Dataloader::Source (class)">Source</a></span>
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#context-instance_method" title="#context (instance method)">#<strong>context</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The Multiplex context.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_runtime-instance_method" title="#current_runtime (instance method)">#<strong>current_runtime</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#yielded_fibers-instance_method" title="#yielded_fibers (instance method)">#<strong>yielded_fibers</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use-class_method" title="use (class method)">.<strong>use</strong>(schema)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enqueue-instance_method" title="#enqueue (instance method)">#<strong>enqueue</strong>(&amp;block)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Add some work to this dataloader to be scheduled later.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(multiplex_context)  &#x21d2; Dataloader </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Dataloader.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">#<strong>run</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Run all Fibers until they’re all done.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with-instance_method" title="#with (instance method)">#<strong>with</strong>(source_class, *batch_parameters)  &#x21d2; GraphQL::Dataloader::Source </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Get a Source instance from this dataloader, for calling <code>.load(...)</code> or <code>.request(...)</code> on.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#yield-instance_method" title="#yield (instance method)">#<strong>yield</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tell the dataloader that this fiber is waiting for data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#yielded%3F-instance_method" title="#yielded? (instance method)">#<strong>yielded?</strong>(path)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>True if the current Fiber has yielded once via Dataloader at path.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(multiplex_context)  &#x21d2; <tt><span class='object_link'><a href="" title="GraphQL::Dataloader (class)">Dataloader</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of Dataloader.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_multiplex_context'>multiplex_context</span><span class='rparen'>)</span>
  <span class='ivar'>@context</span> <span class='op'>=</span> <span class='id identifier rubyid_multiplex_context'>multiplex_context</span>
  <span class='ivar'>@source_cache</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_source_class'>source_class</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_class'>source_class</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h2'>h2</span><span class='comma'>,</span> <span class='id identifier rubyid_batch_parameters'>batch_parameters</span><span class='op'>|</span>
      <span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='id identifier rubyid_source_class'>source_class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_batch_parameters'>batch_parameters</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_setup'>setup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_h2'>h2</span><span class='lbracket'>[</span><span class='id identifier rubyid_batch_parameters'>batch_parameters</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_source'>source</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
  <span class='ivar'>@waiting_fibers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@yielded_fibers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="context-instance_method">
  
    #<strong>context</strong>  &#x21d2; <tt>Hash</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the Multiplex context.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the Multiplex context</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context'>context</span>
  <span class='ivar'>@context</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="current_runtime=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="current_runtime-instance_method">
  
    #<strong>current_runtime</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_runtime'>current_runtime</span>
  <span class='ivar'>@current_runtime</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="yielded_fibers-instance_method">
  
    #<strong>yielded_fibers</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_yielded_fibers'>yielded_fibers</span>
  <span class='ivar'>@yielded_fibers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="use-class_method">
  
    .<strong>use</strong>(schema)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 26</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='id identifier rubyid_schema'>schema</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_dataloader_class'>dataloader_class</span> <span class='op'>=</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="enqueue-instance_method">
  
    #<strong>enqueue</strong>(&amp;block)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Add some work to this dataloader to be scheduled later.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>Some work to enqueue</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53
54
55
56
57
58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 51</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enqueue'>enqueue</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@waiting_fibers</span> <span class='op'>&lt;&lt;</span> <span class='const'>Fiber</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span>
    <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_exception'>exception</span>
      <span class='id identifier rubyid_exception'>exception</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run-instance_method">
  
    #<strong>run</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Run all Fibers until they’re all done</p>

<p>Each cycle works like this:</p>

<ul>
  <li>Run each pending execution fiber (<code>@waiting_fibers</code>),</li>
  <li>Then run each pending Source, preparing more data for those fibers.
    <ul>
      <li>Run each pending Source <em>again</em> (if one Source requested more data from another Source)</li>
      <li>Continue until there are no pending sources</li>
    </ul>
  </li>
  <li>Repeat: run execution fibers again …</li>
</ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 89</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span>
  <span class='comment'># Start executing Fibers. This will run until all the Fibers are done.
</span>  <span class='id identifier rubyid_already_run_fibers'>already_run_fibers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_current_fiber'>current_fiber</span> <span class='op'>=</span> <span class='ivar'>@waiting_fibers</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span><span class='rparen'>)</span>
    <span class='comment'># Run each execution fiber, enqueuing it in `already_run_fibers`
</span>    <span class='comment'># if it&#39;s still `.alive?`.
</span>    <span class='comment'># Any spin-off continuations will be enqueued in `@waiting_fibers` (via {#enqueue})
</span>    <span class='id identifier rubyid_resume_fiber_and_enqueue_continuation'>resume_fiber_and_enqueue_continuation</span><span class='lparen'>(</span><span class='id identifier rubyid_current_fiber'>current_fiber</span><span class='comma'>,</span> <span class='id identifier rubyid_already_run_fibers'>already_run_fibers</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='ivar'>@waiting_fibers</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='comment'># Now, run all Sources which have become pending _before_ resuming GraphQL execution.
</span>      <span class='comment'># Sources might queue up other Sources, which is fine -- those will also run before resuming execution.
</span>      <span class='comment'>#
</span>      <span class='comment'># This is where an evented approach would be even better -- can we tell which
</span>      <span class='comment'># fibers are ready to continue, and continue execution there?
</span>      <span class='comment'>#
</span>      <span class='id identifier rubyid_source_fiber_stack'>source_fiber_stack</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_first_source_fiber'>first_source_fiber</span> <span class='op'>=</span> <span class='id identifier rubyid_create_source_fiber'>create_source_fiber</span><span class='rparen'>)</span>
        <span class='lbracket'>[</span><span class='id identifier rubyid_first_source_fiber'>first_source_fiber</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='kw'>nil</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_source_fiber_stack'>source_fiber_stack</span>
        <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_outer_source_fiber'>outer_source_fiber</span> <span class='op'>=</span> <span class='id identifier rubyid_source_fiber_stack'>source_fiber_stack</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_resume_fiber_and_enqueue_continuation'>resume_fiber_and_enqueue_continuation</span><span class='lparen'>(</span><span class='id identifier rubyid_outer_source_fiber'>outer_source_fiber</span><span class='comma'>,</span> <span class='id identifier rubyid_source_fiber_stack'>source_fiber_stack</span><span class='rparen'>)</span>

          <span class='comment'># If this source caused more sources to become pending, run those before running this one again:
</span>          <span class='id identifier rubyid_next_source_fiber'>next_source_fiber</span> <span class='op'>=</span> <span class='id identifier rubyid_create_source_fiber'>create_source_fiber</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_next_source_fiber'>next_source_fiber</span>
            <span class='id identifier rubyid_source_fiber_stack'>source_fiber_stack</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_next_source_fiber'>next_source_fiber</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='comment'># We ran all the first round of execution fibers,
</span>      <span class='comment'># and we ran all the pending sources.
</span>      <span class='comment'># So pick up any paused execution fibers and repeat.
</span>      <span class='ivar'>@waiting_fibers</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_already_run_fibers'>already_run_fibers</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_already_run_fibers'>already_run_fibers</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with-instance_method">
  
    #<strong>with</strong>(source_class, *batch_parameters)  &#x21d2; <tt><span class='object_link'><a href="Dataloader/Source.html" title="GraphQL::Dataloader::Source (class)">GraphQL::Dataloader::Source</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Get a Source instance from this dataloader, for calling <code>.load(...)</code> or <code>.request(...)</code> on.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>source_class</span>
      
      
        <span class='type'>(<tt>Class&lt;<span class='object_link'><a href="Dataloader/Source.html" title="GraphQL::Dataloader::Source (class)">GraphQL::Dataloader::Source</a></span>]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>ource_class [Class&lt;GraphQL::Dataloader::Source]</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>batch_parameters</span>
      
      
        <span class='type'>(<tt>Array&lt;Object&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Dataloader/Source.html" title="GraphQL::Dataloader::Source (class)">GraphQL::Dataloader::Source</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>An instance of source_class, initialized with <code>self, *batch_parameters</code>,
and cached for the lifetime of this Multiplex.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='id identifier rubyid_source_class'>source_class</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_batch_parameters'>batch_parameters</span><span class='rparen'>)</span>
  <span class='ivar'>@source_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_class'>source_class</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_batch_parameters'>batch_parameters</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="yield-instance_method">
  
    #<strong>yield</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Tell the dataloader that this fiber is waiting for data.</p>

<p>Dataloader will resume the fiber after the requested data has been loaded (by another Fiber).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 67</span>

<span class='kw'>def</span> <span class='kw'>yield</span>
  <span class='const'>Fiber</span><span class='period'>.</span><span class='id identifier rubyid_yield'>yield</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="yielded?-instance_method">
  
    #<strong>yielded?</strong>(path)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns True if the current Fiber has yielded once via Dataloader at path.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Array&lt;String, Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A graphql response path</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>True if the current Fiber has yielded once via Dataloader at path</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/dataloader.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_yielded?'>yielded?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='ivar'>@yielded_fibers</span><span class='lbracket'>[</span><span class='const'>Fiber</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Jan 25 13:47:03 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>