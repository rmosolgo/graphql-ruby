<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: GraphQL::StaticValidation::Validator
  
    &mdash; GraphQL Ruby API Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "GraphQL::StaticValidation::Validator";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (V)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../StaticValidation.html" title="GraphQL::StaticValidation (module)">StaticValidation</a></span></span>
     &raquo; 
    <span class="title">Validator</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: GraphQL::StaticValidation::Validator
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">GraphQL::StaticValidation::Validator</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/graphql/static_validation/validator.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Initialized with a <span class='object_link'><a href="../Schema.html" title="GraphQL::Schema (class)">GraphQL::Schema</a></span>, then it can validate Language::Nodes::Documentss based on that schema.</p>

<p>By default, itâ€™s used by <span class='object_link'><a href="../Query.html" title="GraphQL::Query (class)">Query</a></span></p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'><p>Validate a query</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_validator'>validator</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../StaticValidation.html" title="GraphQL::StaticValidation (module)">StaticValidation</a></span></span><span class='op'>::</span><span class='const'>Validator</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="GraphQL::StaticValidation::Validator#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>schema:</span> <span class='const'>MySchema</span><span class='rparen'>)</span>
<span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Query.html" title="GraphQL::Query (class)">Query</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Query.html#initialize-instance_method" title="GraphQL::Query#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='const'>MySchema</span><span class='comma'>,</span> <span class='id identifier rubyid_query_string'>query_string</span><span class='rparen'>)</span>
<span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='id identifier rubyid_validator'>validator</span><span class='period'>.</span><span class='id identifier rubyid_validate'>validate</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='symbol'>:errors</span><span class='rbracket'>]</span></code></pre>
    
  </div>


</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_timeout-instance_method" title="#handle_timeout (instance method)">#<strong>handle_timeout</strong>(query, context)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Invoked when static validation times out.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(schema:, rules: GraphQL::StaticValidation::ALL_RULES)  &#x21d2; Validator </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Validator.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate-instance_method" title="#validate (instance method)">#<strong>validate</strong>(query, validate: true, timeout: nil, max_errors: nil)  &#x21d2; Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Validate <code>query</code> against the schema.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(schema:, rules: GraphQL::StaticValidation::ALL_RULES)  &#x21d2; <tt><span class='object_link'><a href="" title="GraphQL::StaticValidation::Validator (class)">Validator</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of Validator.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>schema</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Schema.html" title="GraphQL::Schema (class)">GraphQL::Schema</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>rules</span>
      
      
        <span class='type'>(<tt>Array&lt;#<span class='object_link'><a href="#validate-instance_method" title="GraphQL::StaticValidation::Validator#validate (method)">validate</a></span>(context)&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>GraphQL::StaticValidation::ALL_RULES</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>a list of rules to use when validating</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/static_validation/validator.rb', line 18</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='label'>schema:</span><span class='comma'>,</span> <span class='label'>rules:</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../StaticValidation.html" title="GraphQL::StaticValidation (module)">StaticValidation</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../StaticValidation.html#ALL_RULES-constant" title="GraphQL::StaticValidation::ALL_RULES (constant)">ALL_RULES</a></span></span><span class='rparen'>)</span>
  <span class='ivar'>@schema</span> <span class='op'>=</span> <span class='id identifier rubyid_schema'>schema</span>
  <span class='ivar'>@rules</span> <span class='op'>=</span> <span class='id identifier rubyid_rules'>rules</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="handle_timeout-instance_method">
  
    #<strong>handle_timeout</strong>(query, context)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Invoked when static validation times out.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>query</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Query.html" title="GraphQL::Query (class)">GraphQL::Query</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ValidationContext.html" title="GraphQL::StaticValidation::ValidationContext (class)">GraphQL::StaticValidation::ValidationContext</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/static_validation/validator.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_timeout'>handle_timeout</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../StaticValidation.html" title="GraphQL::StaticValidation (module)">StaticValidation</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ValidationTimeoutError.html" title="GraphQL::StaticValidation::ValidationTimeoutError (class)">ValidationTimeoutError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ValidationTimeoutError.html#initialize-instance_method" title="GraphQL::StaticValidation::ValidationTimeoutError#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timeout on validation of query</span><span class='tstring_end'>&quot;</span></span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate-instance_method">
  
    #<strong>validate</strong>(query, validate: true, timeout: nil, max_errors: nil)  &#x21d2; <tt>Array&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Validate <code>query</code> against the schema. Returns an array of message hashes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>query</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Query.html" title="GraphQL::Query (class)">GraphQL::Query</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>validate</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>timeout</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Number of seconds to wait before aborting validation. Any positive number may be used, including Floats to specify fractional seconds.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_errors</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Maximum number of errors before aborting validation. Any positive number will limit the number of errors. Defaults to nil for no limit.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/graphql/static_validation/validator.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate'>validate</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='label'>validate:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>max_errors:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_current_trace'>current_trace</span><span class='period'>.</span><span class='id identifier rubyid_validate'>validate</span><span class='lparen'>(</span><span class='label'>validate:</span> <span class='id identifier rubyid_validate'>validate</span><span class='comma'>,</span> <span class='label'>query:</span> <span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_begin_t'>begin_t</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
    <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_validate'>validate</span> <span class='op'>==</span> <span class='kw'>false</span>
      <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_rules_to_use'>rules_to_use</span> <span class='op'>=</span> <span class='id identifier rubyid_validate'>validate</span> <span class='op'>?</span> <span class='ivar'>@rules</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_visitor_class'>visitor_class</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="BaseVisitor.html" title="GraphQL::StaticValidation::BaseVisitor (class)">BaseVisitor</a></span></span><span class='period'>.</span><span class='id identifier rubyid_including_rules'><span class='object_link'><a href="BaseVisitor.html#including_rules-class_method" title="GraphQL::StaticValidation::BaseVisitor.including_rules (method)">including_rules</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rules_to_use'>rules_to_use</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../StaticValidation.html" title="GraphQL::StaticValidation (module)">StaticValidation</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ValidationContext.html" title="GraphQL::StaticValidation::ValidationContext (class)">ValidationContext</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ValidationContext.html#initialize-instance_method" title="GraphQL::StaticValidation::ValidationContext#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_visitor_class'>visitor_class</span><span class='comma'>,</span> <span class='id identifier rubyid_max_errors'>max_errors</span><span class='rparen'>)</span>

      <span class='kw'>begin</span>
        <span class='comment'># CAUTION: Usage of the timeout module makes the assumption that validation rules are stateless Ruby code that requires no cleanup if process was interrupted. This means no blocking IO calls, native gems, locks, or `rescue` clauses that must be reached.
</span>        <span class='comment'># A timeout value of 0 or nil will execute the block without any timeout.
</span>        <span class='const'>Timeout</span><span class='op'>::</span><span class='id identifier rubyid_timeout'>timeout</span><span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_catch'>catch</span><span class='lparen'>(</span><span class='symbol'>:too_many_validation_errors</span><span class='rparen'>)</span> <span class='kw'>do</span>
            <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_visitor'>visitor</span><span class='period'>.</span><span class='id identifier rubyid_visit'>visit</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>rescue</span> <span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span>
        <span class='id identifier rubyid_handle_timeout'>handle_timeout</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span>
    <span class='kw'>end</span>

    <span class='lbrace'>{</span>
      <span class='label'>remaining_timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>?</span> <span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_begin_t'>begin_t</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='kw'>nil</span><span class='comma'>,</span>
      <span class='label'>errors:</span> <span class='id identifier rubyid_errors'>errors</span><span class='comma'>,</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../../GraphQL.html" title="GraphQL (module)">GraphQL</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../ExecutionError.html" title="GraphQL::ExecutionError (class)">ExecutionError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='lbrace'>{</span>
    <span class='label'>remaining_timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>errors:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Dec  5 13:47:48 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.2.6).
</div>

    </div>
  </body>
</html>